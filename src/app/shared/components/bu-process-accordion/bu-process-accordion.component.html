<div class="bp-wrapper" *ngIf="currentNodes?.length">

  <div class="breadcrumb" *ngIf="breadcrumb.length">
    <button mat-button (click)="jumpTo(-1)">
      <mat-icon>home</mat-icon>
      <span>Accueil</span>
    </button>
    <button mat-button *ngFor="let c of breadcrumb; let i = index" (click)="jumpTo(i)">
      <mat-icon>chevron_right</mat-icon>
      <span>{{ c.name }}</span>
    </button>
  </div>

  <div class="list-panel">

    <div>
      <div class="panel-title">
        <div>
          {{ getViewTitle() }}
          <span *ngIf="breadcrumbDisplay"> de « {{ breadcrumbDisplay }} »</span>
        </div>

        <div class="panel-title-actions">

          <button *ngIf="breadcrumb.length > 0" mat-stroked-button (click)="back()">
            <mat-icon>arrow_back</mat-icon> Retour
          </button>
        </div>
      </div>

      <mat-list style="display: flex
;
    flex-direction: column;
    gap: 20px;">
        <mat-list-item *ngFor="let node of currentNodes">
          <div class="node-content">
            <div style="display: flex
;
    gap: 20px;
    align-items: baseline;">
              <h3 class="node-title">{{ node.name }}</h3>
              <p *ngIf="node.lm" class="node-subtitle">{{ node.lm ? 'LM' : '' }}</p>
            </div>
          </div>

          <div class="node-actions">

            <button *ngIf="hasChildren(node)" mat-stroked-button (click)="enterNode(node)">
              <mat-icon>account_tree</mat-icon>
              Voir la hiérarchie
            </button>


            <button *ngIf="canViewNextLevel(node)" mat-stroked-button color="primary"
              (click)="viewNextLevel(node); $event.stopPropagation()">
              <mat-icon>visibility</mat-icon>
              {{ getNextLevelButtonText(node) }}
            </button>


            <button *ngIf="view === 'risks'" mat-stroked-button color="accent"
              (click)="selectRisk(node); $event.stopPropagation()">
              <mat-icon>check</mat-icon> {{ consultationMode == 'admin' ? 'Choisir' : 'Sélectionner le risque' }}
            </button>


            <ng-container *ngIf="(!view || view !== 'risks') && consultationMode == 'admin'">

              <button mat-icon-button color="primary">
                <mat-icon>edit</mat-icon>
              </button>


              <button mat-icon-button color="warn">
                <mat-icon>delete</mat-icon>
              </button>
            </ng-container>
          </div>
        </mat-list-item>
      </mat-list>


    </div>
  </div>
</div>
<div *ngIf="!currentNodes?.length" class="empty">
  <mat-spinner></mat-spinner>
  Chargment des données...
</div>