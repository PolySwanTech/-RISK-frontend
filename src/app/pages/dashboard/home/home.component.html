<app-go-back [title]="'Tableau de bord'" [buttons]="goBackButtons"></app-go-back>

<section class="dashboard-container">

  <!-- Section des onglets -->
  <mat-tab-group animationDuration="300ms" color="primary" mat-align-tabs="center">

    <!-- Onglet Incidents -->
    <mat-tab label="Incidents">

  <!-- 1Ô∏è‚É£ Graphe de tendances -->
  <div class="trend-container">
    <app-incidents-trend-chart [incidents]="filteredIncidents"></app-incidents-trend-chart>
  </div>

  <!-- 2Ô∏è‚É£ Filtre par p√©riode personnalis√©e -->
  <div class="filter-container">
    <mat-form-field appearance="outline">
      <mat-label>Date de d√©but</mat-label>
      <input matInput [matDatepicker]="pickerStart" [(ngModel)]="startDate" placeholder="Choisir une date" />
      <mat-datepicker-toggle matSuffix [for]="pickerStart"></mat-datepicker-toggle>
      <mat-datepicker #pickerStart></mat-datepicker>
    </mat-form-field>

    <mat-form-field appearance="outline">
      <mat-label>Date de fin</mat-label>
      <input matInput [matDatepicker]="pickerEnd" [(ngModel)]="endDate" placeholder="Choisir une date" />
      <mat-datepicker-toggle matSuffix [for]="pickerEnd"></mat-datepicker-toggle>
      <mat-datepicker #pickerEnd></mat-datepicker>
    </mat-form-field>

    <button mat-raised-button color="primary" (click)="applyDateFilter()">Appliquer</button>
    <button mat-stroked-button color="warn" (click)="clearDateFilter()">R√©initialiser</button>
  </div>


<!-- üî∫ Pyramide des incidents -->
<div class="incident-pyramid">

  <!-- Sommet : Total -->
  <div class="pyramid-top">
    <mat-card class="total">
      <mat-card-title>Total d‚Äôincidents</mat-card-title>
      <mat-card-content>{{ totalIncidents }}</mat-card-content>
      <p class="resolution-rate">Dur√©e moyenne de r√©solution: {{ avgResolutionTime }}</p>
    </mat-card>
  </div>

  <!-- Niveau interm√©diaire : En cours / R√©solus -->
  <div class="pyramid-middle">
    <mat-card class="in-progress">
      <mat-card-title>En cours</mat-card-title>
      <mat-card-content>{{ inProgressIncidents }}</mat-card-content>
      <p class="resolution-rate">{{ draftIncidents }} en brouillon</p>
    </mat-card>

    <mat-card class="resolved">
      <mat-card-title>R√©solus</mat-card-title>
      <mat-card-content>{{ resolvedIncidents }}</mat-card-content>
      <p class="resolution-rate"><strong>{{ resolutionRate }}%</strong> taux de r√©solution</p>
    </mat-card>
  </div>
</div>


  <!-- 4Ô∏è‚É£ Autres graphiques -->
  <div class="graphs-container">
    <app-baloise-category-chart [incidents]="filteredIncidents"></app-baloise-category-chart>
  </div>

</mat-tab>


    <!-- Onglet Contr√¥les -->
    <mat-tab label="Contr√¥les">
      <div class="controls-dashboard">
        
        <!-- Ligne 1 -->
        <div class="controls-row">
          <app-control-completion-rate></app-control-completion-rate>
          <app-control-status-chart></app-control-status-chart>
        </div>

        <!-- Ligne 2 -->
        <div class="controls-row">
          <app-control-result-chart></app-control-result-chart>
        </div>

      </div>
    </mat-tab>


    <!-- Onglet Plans d‚Äôaction -->
    <mat-tab label="Plans d‚Äôaction">
      <div class="graphs-container">
      </div>
    </mat-tab>

  </mat-tab-group>

</section>
