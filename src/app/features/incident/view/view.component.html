<div style="margin: 15px;">
    @if(incident){
    <app-go-back previousPageName="Liste des incidents" [currentPageName]="`Détails de l'incident - ` + incident.title"></app-go-back>
    <mat-card class="incident-card">
        <mat-card-header>
            <mat-card-title> <span>Détails de l'incident - Status : <strong>{{ incident.state }}</strong></span>
                @if(isNotClosed()){
                <button (click)="close()">Cloturer</button>
                }
            </mat-card-title>
        </mat-card-header>
        <mat-card-content>
            <div class="incident-info">
            </div>
        </mat-card-content>
    </mat-card>

    <mat-card class="impact-card">
        <mat-card-header>
            <mat-card-title>Impacts</mat-card-title>
        </mat-card-header>
        <mat-card-content>
            @if(isNotClosed()){
            <button class="add" color="primary" (click)="addImpact()">
                <mat-icon>add</mat-icon>
                Ajouter
            </button>
            }
            <mat-list class="impacts-list">
                <div class="impacts-container">
                    @for(impact of incident.impacts; track impact){
                    <app-impact-card [impact]="impact"></app-impact-card>
                    }
                </div>
            </mat-list>
        </mat-card-content>
    </mat-card>

    <mat-card class="state-card">
        <mat-card-header>
            <mat-card-title>Commentaires</mat-card-title>
        </mat-card-header>
        <mat-card-content>
            <div class="incident-state">
                <mat-form-field appearance="outline" class="full-width">
                    <mat-label>Commentaire</mat-label>
                    <textarea matInput name="incident-com" id="commentaire" [(ngModel)]="incident.comments"></textarea>
                </mat-form-field>

            </div>
            <div style="text-align: end;">
                <button [disabled]="!hasChange()" (click)="updateCommentaire()">Mettre à jour</button>
            </div>
        </mat-card-content>
    </mat-card>
    }
</div>