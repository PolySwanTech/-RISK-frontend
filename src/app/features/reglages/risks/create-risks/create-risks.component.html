<div class="body-container">
  <app-go-back [title]="'Création d\'un évenement de risque'" />

  <section>
    <div class="form-container">
      <h2>{{ pageTitle }}</h2>

      <!-- le stepper n’est affiché que lorsque l’objet risk est prêt -->
      @if (risk) {
      <form [formGroup]="infoForm">
            <!-- Titre --------------------------------------------------------- -->
            <mat-form-field class="full-width">
              <mat-label>Titre du risque</mat-label>
              <input matInput formControlName="libellePerso" placeholder="Entrez le titre du risque" />
            </mat-form-field>

            <!-- Parent ----------------------------------------------------- -->
            <mat-form-field class="full-width">
              <mat-label>Risque parent</mat-label>
              <mat-select formControlName="parentRisk">
                <mat-option [value]="undefined">Aucun</mat-option>
                <!-- on utilise risk.id pour lier le risque parent -->
                <mat-option *ngFor="let r of risks" [value]="r.id">
                  {{ r.libelle }}
                </mat-option>
              </mat-select>
            </mat-form-field>

            <app-select-arborescence tooltip="Sélectionnez le processus associé" *ngIf="listProcess.length > 0"
              [id]="infoForm.get('processId')!.value" (changeValue)="onProcessSelected($event)"
              placeholder="Sélectionnez un processus" [list]="listProcess">
            </app-select-arborescence>

            <div class="actions">

              <button mat-raised-button class="btn-red" matStepperPrevious *ngIf="risk.id">
                Annuler
              </button>

              <button mat-raised-button class="btn-primary" (click)="submit()" [disabled]="infoForm.invalid">
                Soumettre
              </button>
            </div>
          </form>
      }
    </div>
  </section>
</div>