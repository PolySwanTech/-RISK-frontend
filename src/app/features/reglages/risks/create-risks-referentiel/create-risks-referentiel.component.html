<app-base-popup 
  [title]="data.riskId ? 'Modifier le risque référentiel' : 'Créer un risque référentiel'" 
  [showClose]="true"
  [actions]="popupActions"
  [dialogRef]="getDialogRef()"
  (close)="closePopup()">
  
  <form [formGroup]="infoForm">
    <!-- Section Informations principales -->
    <div class="section">
      <div class="section-header">
        <mat-icon class="section-icon">info</mat-icon>
        <h3 class="section-title">Informations du risque</h3>
      </div>
      <div class="section-content">
        <!-- Titre -->
        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Titre du risque</mat-label>
          <input matInput formControlName="libellePerso" placeholder="Entrez le titre du risque" />
          <mat-icon matPrefix>title</mat-icon>
        </mat-form-field>

        <!-- Description -->
        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Description du risque</mat-label>
          <textarea matInput formControlName="description" placeholder="Entrez la description" rows="4"></textarea>
          <mat-icon matPrefix>description</mat-icon>
        </mat-form-field>
      </div>
    </div>

    <!-- Section Catégorie Bâloise -->
    <div class="section">
      <div class="section-header">
        <mat-icon class="section-icon">category</mat-icon>
        <h3 class="section-title">Catégorie Bâloise*</h3>
        <div class="section-header-actions" *ngIf="!isBaloisPreselected">
          <button mat-raised-button type="button" class="btn-purple" (click)="openSubCategorySelector()">
            <mat-icon>add</mat-icon>
            Associer un Risque Bâlois
          </button>
        </div>
      </div>
      <div class="association-content">
        <mat-chip-listbox *ngIf="balois">
          <mat-chip>{{ balois.label }}</mat-chip>
        </mat-chip-listbox>
        <div class="empty-state" *ngIf="!balois">
          <mat-icon>category</mat-icon>
          <p>Aucune catégorie Bâloise sélectionnée. Cliquez sur "Associer un Risque Bâlois" pour commencer.</p>
        </div>
      </div>
    </div>
  </form>
</app-base-popup>