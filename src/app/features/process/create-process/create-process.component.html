<div class="container">
<h2>Créer un Processus</h2>

<form [formGroup]="processForm" (ngSubmit)="onSubmit()">
  <!-- Nom du Processus -->
  <mat-form-field class="full-width">
    <mat-label>Nom du Processus</mat-label>
    <input matInput type="text" formControlName="name" placeholder="Entrez le nom du processus" />
    <mat-error *ngIf="processForm.get('name')?.invalid && processForm.get('name')?.touched">
      Le nom est requis.
    </mat-error>
  </mat-form-field>

  <!-- Business Unit -->
  <mat-form-field class="full-width">
    <mat-label>Business Unit</mat-label>
    <mat-select formControlName="buId"
                (selectionChange)="onBuChange($event.value)">
      <mat-option *ngFor="let bu of businessUnits" [value]="bu.id">
        {{ bu.name }}
      </mat-option>
    </mat-select>
    <mat-error *ngIf="processForm.get('buId')?.invalid && processForm.get('buId')?.touched">
      La BU est requise.
    </mat-error>
  </mat-form-field>

  <!-- Processus Parent (optionnel) -->
  @if (processes.length != 0) {
    <div class="row-add">
      <app-select-arborescence appearance="outline" placeholder="Sélectionnez un processus parent"  *ngIf="processes.length > 0" [id]="processForm.get('parentId')!.value" (changeValue)="onSelectionProcess($event)"
        [list]="processes" />
    </div>
  }

  <!-- Bouton de soumission -->
  <div class="actions">
    <button mat-raised-button color="primary" type="submit" [disabled]="processForm.invalid">
      Créer le Process
    </button>
  </div>
</form>
</div>

