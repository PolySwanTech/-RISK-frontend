<div class="container">
  <div class="sidebar">
    <div class="sidebar-header">
      <h3>Risques</h3>
    </div>
    <div class="sidebar-content">
      <ul class="risks-list">
        <li *ngFor="let risk of risks" (click)="getProcessByRisks(risk)" [class.selected]="risk === selectedRisk"
          class="risk-item">
          <span class="risk-label">{{ risk.libellePerso }}</span>
        </li>
      </ul>
    </div>
  </div>

  <div class="content" *ngIf="selectedRisk">
    <div class="content-header">
      <h2 class="risk-title">{{ selectedRisk.libellePerso }}</h2>
      <div class="impact-summary">
        <span class="impact-label">Total des pertes ({{ selectedYear }}):</span>
        <span class="impact-value">{{ totalImpact | currency:'EUR' }}</span>
      </div>
    </div>

    <div class="section processes-section">
      <h4 class="section-title">Processus impactés</h4>
      <ul class="processes-list">
        <li *ngFor="let process of processes" (click)="getControlsByProcessAndRisk(process)"
          [class.selected]="process === selectedProcess" class="process-item">
          <span class="process-name">{{ process.name }} - {{process.sum || 0}} €</span>
          

          <!-- <span class="process-impact">{{ process.impact | currency:'EUR' }}</span> -->
        </li>
      </ul>
    </div>

    <div class="section controls-section" *ngIf="selectedProcess">
      <h4 class="section-title">Contrôles liés</h4>
      <ul class="controls-list">
        <li *ngFor="let control of controls" (click)="selectedControl = control"
          [class.selected]="control === selectedControl" class="control-item">
          <span class="control-label">{{ control.libelle }}</span>
        </li>
      </ul>
    </div>

    <div class="section evaluation-section" *ngIf="selectedControl">
      <h4 class="section-title">Évaluer le contrôle : {{ selectedControl.libelle }}</h4>
      <app-risk-evaluation [riskId]="selectedRisk.id.id" (onSumbit)="submitEvaluation($event)" ></app-risk-evaluation>
    </div>
  </div>

  <div class="empty-state" *ngIf="!selectedRisk">
    <div class="empty-state-content">
      <h3>Sélectionnez un risque</h3>
      <p>Choisissez un risque dans la liste pour commencer l'évaluation</p>
    </div>
  </div>
</div>