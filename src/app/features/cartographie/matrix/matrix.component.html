<app-go-back [title]="`Paramétrage de la matrice d'aversion de ` + buName" [buttons]="goBackButtons"></app-go-back>

<section class="dashboard-container">
  <div class="matrix-container">
    <section id="matrix">

      <div class="matrix-container">

        <!-- Axe vertical IMPACT -->
        <div class="impact-label">IMPACT</div>

        <div class="matrix-wrapper">
          <table class="risk-matrix">
            <tbody>
              <tr *ngFor="let row of matrixLevels; let rIdx = index; trackBy: trackByIdx">
                <th class="row-header">
                  <label class="row-input">{{rowLabels[matrixLevels.length - 1 - rIdx].libelle}}</label>
                </th>

                <td *ngFor="let cell of row; let cIdx = index; trackBy: trackByIdx" [ngStyle]="cellStyle(cell)"
                  (click)="openColorOverlay($event, cell)" class="matrix-cell">
                </td>
                <div *ngIf="activeCell" class="color-overlay" [ngStyle]="overlayPosition">
                  <div *ngFor="let risk of riskLevels" class="color-box" [style.background]="risk.color"
                    (click)="selectColor(activeCell, risk)">
                    {{ risk.name | enumLabel: 'riskLevel' }}
                  </div>
                </div>
              </tr>

              <!-- ligne d’entête des colonnes PROBABILITÉ -->
              <tr class="column-labels-row">
                <th class="probability-header">PROBABILITÉ</th>
                <td *ngFor="let _ of colLabels; let i = index; trackBy: trackByIdx" (click)="openScaleOverlay($event, colLabels[i])">
                  <label class="col-input">
                    {{colLabels[i].libelle}}</label>
                </td>
                <div *ngIf="activeScale" class="scale-overlay" [ngStyle]="overlayPosition">
                  <label>Min : </label>
                  <input type="number" [(ngModel)]="activeScale.min">
                  <label>Max : </label>
                  <input type="number" [(ngModel)]="activeScale.max">
                </div>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </section>
  </div>
</section>